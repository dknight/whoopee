<!-- Description: Sime guide about 1-bit monochrome images: how to parse meta data from 1-bit bitmap files. Creating monochrome images with ImageMagick, GIMP, MS Paint, and other image processing software. -->

tags: c gamedev

# Monochrome 1-bit image parsing

When I tried to use [Arduino](https://www.arduino.cc/) to make a simple game
for TV [Sayzo](https://github.com/dknight/sayzo). There was need to parse
1-bit data from bitmap (*.bmp) image to bytes for input to C.

I haven't found anything suitable on the web that time (2014?). I made
decision to write my own utility, which recently I have upgraded code of it.

## BMP format

Actually, the BMP format is very simple; it consists of 2 parts: a header
with metadata and actual bytes without any compression.

### Header

| Bytes   | Value/Type  |                          |
----------|-------------|--------------------------|
| 2 bytes | 0x4D42      | BMP format identifier    |
| 4 bytes | uint32_t    | File size in bytes       |
| 2 bytes | int16_t     | not in use/reserved      |
| 2 bytes | int16_t     | not in use/reserved      |
| 4 bytes | uint32_t    | Offset to image data in bytes from beginning of file
| 4 bytes | uint32_t    | DIB Header size in bytes |
| 4 bytes | int32_t     | Width of the image       |
| 4 bytes | int32_t     | Height of the image      |
| 2 bytes | uint16_t    | Number of color planes   |
| 2 bytes | uint16_t    | Bits per pixel           |
| 4 bytes | uint32_t    | Compression type         |
| 4 bytes | uint32_t    | Image size in bytes      |
| 4 bytes | int32_t     | Pixels per meter (X)     |
| 4 bytes | int32_t     | Pixels per meter (Y)     |
| 4 bytes |	uint32_t    | Number of colors         |
| 4 bytes |	uint32_t    | Important colors         |

### Data

After the header data, follow plain data in bytes as `unit8_t` or
`unsigned char`. This makes parsing extremely easy.

Check [bmp2bytes](https://github.com/dknight/bmp2bytes/) to parse the 1-bit
images and get image data and header.

## Example

![Girl 1-bit](/assets/img/girl.bmp)

```shell
bmp2bytes -f "0x%x" -d "," -n ./tests/girl.bmp
```

<details>
<summary>Example of output</summary>
<pre class="break">0xff,0xfe,0x0,0x0,0x5f,0xff,0xff,0x6a,0x80,0x0,0x0,0x7f,0xfa,0xaa,0xad,0xdd,0xfd,0x0,0x0,0x35,0xbb,0xb5,0xb5,0x0,0x0,0x0,0x7f,0x7f,0x55,0x55,0xff,0xef,0x0,0x0,0x3f,0xdd,0xff,0x5a,0x60,0x0,0x0,0x3b,0xea,0xd6,0xd6,0x7f,0x7e,0x0,0x0,0x55,0xff,0xad,0xef,0x80,0x0,0x0,0x3f,0xfd,0x52,0x5b,0xdb,0xfd,0x0,0x0,0x7e,0xdd,0xf6,0xb2,0xe0,0x0,0x0,0x3b,0xfe,0xbb,0x4d,0xff,0xee,0x0,0x0,0xb7,0xff,0xbf,0xdf,0x10,0x0,0x0,0x7e,0xdd,0x4d,0xb6,0xef,0xfc,0x0,0x0,0x5f,0x6d,0xfd,0x74,0xe0,0x0,0x0,0x2f,0xf7,0xb4,0xa9,0xfd,0xfc,0x0,0x0,0xf7,0xff,0xdf,0xde,0x90,0x0,0x0,0x3f,0xfa,0xa6,0x6d,0xff,0xfc,0x0,0x0,0xbf,0xfd,0xf7,0xf7,0x50,0x0,0x0,0x37,0xbf,0x57,0x56,0xfe,0xdc,0x0,0x1,0x7e,0xef,0xfd,0x5d,0xc0,0x0,0x0,0x3e,0xfa,0xb2,0xb6,0xdf,0xfc,0x0,0x0,0xf1,0xbf,0xaf,0xff,0x58,0x0,0x0,0x3f,0xed,0x4d,0x4d,0xef,0xf4,0x0,0x1,0x0,0x15,0xfb,0xb5,0x40,0x0,0x0,0x16,0xfd,0xd5,0xb5,0xff,0xf8,0x0,0x0,0xfa,0x1,0x7d,0xdf,0xf8,0x0,0x0,0x7f,0xde,0x4a,0x96,0xfb,0xf8,0x0,0x1,0x7f,0x80,0x6f,0xfa,0xa0,0x0,0x0,0x36,0xfb,0x75,0x6b,0xff,0xb8,0x0,0x0,0xd4,0x68,0x1a,0x6f,0x0,0x0,0x0,0x3f,0x6a,0x8a,0xdc,0x7d,0xf8,0x0,0x0,0x40,0x3,0x2f,0xb0,0x0,0x0,0x0,0x17,0xfa,0xea,0x47,0xdf,0xf8,0x0,0x4,0x40,0x1,0xf7,0xb0,0x0,0x0,0x0,0x7a,0xdd,0x2a,0xb2,0xff,0xd0,0x0,0x1,0x0,0x0,0x5a,0xc8,0xa,0x0,0x0,0xf,0xb6,0xd5,0x5b,0xf7,0x70,0x0,0xc,0x0,0x8,0x2f,0xa8,0x1,0x0,0x0,0x26,0xf9,0x2a,0xa4,0xbf,0xf0,0x0,0x3,0x50,0x0,0x5a,0xa0,0x0,0x0,0x0,0x33,0xde,0x4d,0xb7,0xfb,0xd0,0x0,0x9,0x11,0x0,0x2f,0x80,0x0,0x0,0x0,0x39,0x75,0x64,0xb2,0xff,0x60,0x0,0x2,0xce,0xea,0x9e,0x40,0x10,0x0,0x0,0x15,0xfb,0x16,0xcd,0xaf,0xe0,0x0,0x9,0x6d,0x39,0x6b,0x40,0x0,0x0,0x0,0x1d,0x55,0x69,0x36,0xfb,0xe0,0x2,0x6,0xb7,0xed,0x5f,0xa8,0x0,0x0,0x0,0x15,0x5e,0x96,0x93,0xff,0xe0,0x1,0x1,0x52,0xaa,0xf6,0x85,0x40,0x0,0x0,0xf,0xea,0x92,0xd9,0xdd,0xe0,0x0,0x1a,0xdd,0xf5,0x5f,0x6a,0xa8,0x0,0x0,0x4,0xad,0x69,0x25,0xff,0xa0,0x0,0x1,0x6a,0xaf,0xee,0x91,0x50,0x0,0x0,0x3,0xfa,0x96,0xd6,0xef,0xf0,0x0,0x5,0xaf,0xf7,0x77,0x5b,0x58,0x0,0x0,0x8,0xae,0x52,0x55,0xff,0xe0,0x0,0x0,0xaa,0xbb,0xdd,0x29,0xaa,0x0,0x0,0x4,0xd3,0x5a,0xaa,0xfb,0x70,0x0,0x1,0xa7,0x75,0x77,0x9e,0xd4,0x0,0x0,0x6,0x7c,0x85,0x55,0xdf,0xf0,0x0,0x0,0x59,0xde,0xde,0xa5,0x68,0x0,0x0,0x1,0x8b,0x5a,0xab,0xf7,0xb8,0x0,0x9,0x4d,0xeb,0x7f,0x9b,0x2a,0x0,0x0,0x0,0x69,0x4a,0xa8,0xfb,0xf0,0x0,0x4,0x65,0x6a,0xba,0xcd,0xe8,0x0,0x0,0x1,0x6c,0xaa,0xaf,0xbf,0xf8,0x0,0x2,0x92,0xb5,0xdf,0xa6,0xa8,0x0,0x0,0x0,0xb2,0x49,0x50,0xff,0xb8,0x0,0x1,0x39,0xd9,0x6f,0xad,0xd4,0x0,0x0,0x0,0x4d,0x2a,0xa7,0xf7,0xe8,0x0,0x2,0x8c,0x6d,0xa2,0xaa,0x50,0x0,0x0,0x0,0x32,0x8a,0xb2,0xff,0xf8,0x0,0x2,0xb2,0x54,0xa,0x97,0xa8,0x0,0x0,0x0,0x1d,0x65,0x9a,0xf5,0x78,0x0,0x1,0x1d,0x2a,0xa,0x29,0x50,0x0,0x0,0x0,0x2a,0x94,0x65,0xbf,0xdc,0x0,0x12,0xab,0xd5,0x74,0x16,0xa4,0x0,0x0,0x0,0x8,0xa9,0xaa,0xff,0xfc,0x0,0x1,0xaa,0x5a,0x93,0x4a,0xa0,0x0,0x0,0x0,0x6,0x26,0x95,0xff,0xd8,0x0,0x10,0xbf,0x6a,0x98,0x6b,0x20,0x0,0x0,0x0,0x1,0x10,0xc5,0xad,0xfc,0x0,0x1,0xc9,0xb7,0x67,0x24,0x90,0x0,0x0,0x0,0xa,0xca,0x34,0xff,0x7e,0x0,0x0,0x66,0x58,0x95,0x5a,0xd0,0x0,0x0,0x0,0x3,0x2a,0xc9,0xff,0xbe,0x0,0x10,0x73,0x48,0x0,0x4b,0x0,0x0,0x0,0x0,0x1,0xa2,0x4a,0xb7,0xde,0x0,0x10,0x35,0x80,0x1,0x29,0xd0,0x0,0x0,0x0,0x1,0x51,0x49,0xff,0xed,0x0,0x18,0x5a,0x0,0x0,0x4,0x20,0x0,0x0,0x0,0x1,0x5c,0x24,0xfd,0xff,0x0,0xc,0x2d,0x60,0x0,0xb,0x80,0x0,0x0,0x0,0x0,0xa1,0x55,0xde,0xf7,0x0,0xc,0x16,0xb4,0x80,0x0,0x80,0x0,0x0,0x0,0x0,0x54,0x82,0xff,0x7d,0x0,0xe,0xa,0x92,0xa4,0x1a,0x80,0x0,0x0,0x0,0x0,0x52,0x51,0xeb,0xdf,0x80,0xb,0x5,0x68,0x10,0x22,0x0,0x0,0x0,0x0,0x0,0x9,0x2c,0xff,0x77,0x0,0x16,0x85,0xb5,0x44,0x8c,0x0,0x0,0x0,0x0,0x0,0x6,0x42,0x7f,0xfb,0x80,0xb,0xc0,0xdd,0x42,0x62,0x0,0x0,0x0,0x0,0x0,0x1,0x22,0xfb,0xfe,0x0,0x1a,0xa2,0x55,0x6b,0x10,0x0,0x0,0x0,0x0,0x0,0x0,0x11,0xaf,0x6b,0x0,0x16,0xf0,0xaf,0xb4,0xa0,0x0,0x0,0x0,0x0,0x0,0x0,0x5,0xfd,0xf4,0x0,0x4d,0xd8,0x29,0x4d,0x40,0x0,0x0,0x0,0x0,0x0,0x1,0x40,0xef,0x50,0x3,0x2b,0x6c,0x25,0x65,0x40,0x0,0x0,0x0,0x0,0x1,0x10,0x30,0xf5,0x0,0x1,0x2d,0x77,0x15,0x34,0x0,0x0,0x0,0x0,0x0,0x0,0x88,0xa,0xbc,0x0,0x1,0x57,0xad,0x82,0xca,0x0,0x0,0x0,0x0,0x0,0x1,0xa6,0x9,0x6a,0x0,0x0,0x9a,0xf6,0xa0,0x10,0x0,0x0,0x0,0x0,0x0,0x0,0x50,0x82,0xad,0x80,0x0,0x5f,0x5a,0xd8,0x0,0x0,0x0,0x0,0x0,0x0,0x1,0x16,0x52,0xf4,0x80,0x0,0x2b,0x6e,0xea,0x0,0x0,0x0,0x0,0x0,0x0,0x1,0x52,0xba,0xd8,0xc0,0x0,0x17,0xfb,0x2d,0xa0,0x0,0x0,0x0,0x0,0x0,0x0,0x98,0xdd,0xf9,0x60,0x0,0x1e,0x95,0xd5,0x50,0x0,0x0,0x0,0x0,0x0,0x0,0x66,0x67,0xfd,0xe0,0x0,0xb,0xfd,0x75,0xd0,0x0,0x0,0x0,0x0,0x0,0x0,0x1b,0x3d,0xff,0xe0,0x0,0x2d,0xaf,0x5a,0x40,0x0,0x0,0x0,0x0,0x0,0x0,0x69,0x4d,0xf9,0xa0,0x0,0xf,0x7b,0xef,0xa0,0x0,0x0,0x0,0x0,0x0,0x0,0x15,0x36,0xfd,0xf0,0x0,0x5,0xf6,0xa9,0x40,0x0,0x0,0x0,0x0,0x0,0x0,0x2a,0x95,0xfd,0xd0,0x0,0x2,0xda,0xee,0xa0,0x0,0x0,0x0,0x0,0x0,0x0,0x14,0x8a,0xfe,0xf0,0x0,0x1,0x7d,0x76,0x80,0x0,0x0,0x0,0x0,0x0,0x0,0xa,0x4b,0xfe,0xd0,0x0,0x1,0x56,0xab,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x5,0x28,0xfc,0xe8,0x0,0x0,0xb9,0x6e,0x80,0x0,0x0,0x0,0x0,0x0,0x0,0x2,0xcb,0xfe,0x78,0x0,0x0,0xd,0x32,0x80,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x64,0xff,0x78,0x0,0x0,0x2a,0xae,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x5,0x35,0xff,0x30,0x0,0x0,0x1,0x59,0x0,0x0,0x0,0x0,0x0,0x0,0x1,0x40,0x4a,0xff,0xb8,0x0,0x0,0x14,0xa6,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x11,0xff,0xdc,0x0,0x0,0x2,0x29,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x40,0x8c,0xff,0xdc,0x0,0x0,0x1,0x14,0x80,0x0,0x0,0x0,0x0,0x0,0x0,0x10,0x2,0xff,0x9a,0x0,0x0,0x0,0x8a,0x0,0x0,0x40,0x0,0x0,0x0,0x0,0x0,0x48,0xff,0xc6,0x0,0x0,0x2,0x28,0x0,0x0,0x80,0x0,0x0,0x0,0x0,0x10,0x2,0xff,0xf1,0x0,0x0,0x0,0x6,0x80,0x0,0xc0,0x0,0x0,0x0,0x0,0x0,0x0
</pre>
</details>

## Creating 1-bit bitmaps

### GIMP

1. *Toolbar > Image > Mode > Index*
2. *File > Export as...*
3. Save file with extension bmp.

### ImageMagick

[ImageMagick](https://imagemagick.org/) has an enormous amount of image
processing features. It can covert any file to a 1-bit bitmap with a
single command:

ImageMagick <7
```shell
magick convert -monochrome image.png 1bit.bmp
```

ImageMagick 7+

```shell
magick image.png -monochrome 1bit.bmp
```

### MS Paint and lots of other image editors

Process of creating monochrome images in the most of the image
editors is the same. Just set the image to an indexed palette with 2
colors black and white and save.