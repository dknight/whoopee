<!doctype html><html lang=en><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><meta content="Explanation of the typing system in the Lua language provided by Lua Language Server Annotations. Learn how to annotate types for your projects and functions. " name=description><meta content="lua, programming, algorithms, data-structures, gamedev, game development, blog, personal" name=keywords><meta content="Dmitri Smirnov" name=author><meta content=website property=og:type><meta content=https://www.whoop.ee/post/strictly-typed-lua.html property=og:url><meta content=https://www.whoop.ee/assets/img/whoopee-logo-black.png property=og:image><meta content="script-src 'self'" http-equiv=Content-Security-Policy><meta content="object-src 'none'" http-equiv=Content-Security-Policy><title>Strictly typed Lua — Whoopee</title><link as=font href=/assets/fonts/Perfect_DOS_VGA_437.woff2 rel=preload><link href=/favicon.ico rel=icon type=image/x-icon><link href=/assets/css/styles.min.css rel=stylesheet><link title="RSS Feed" href=/feed.xml rel=alternate type=application/rss+xml><link href=https://www.whoop.ee/post/strictly-typed-lua.html rel=canonical><body><header><a href=/><img alt=Whoopee class=logo height=172 src=/assets/img/whoopee-logo.png width=200></a><nav class=mainmenu><a class=mainmenu-toolbox href=/post/lua-toolbox.html>Lua Toolbox</a><a class=mainmenu-about href=/me/>About</a><a class=mainmenu-rss href=/feed.xml>RSS</a></nav></header><main><a href=/>← Back to the index page</a><article><h1>Strictly typed Lua</h1><time datetime=2025-03-11> March 11, 2025 </time><p>First of all, Lua is a dynamically typed language. This means that variables do not have types; <strong>only values do</strong>. All values in Lua are first-class citizens, which means that all values can be stored in variables and passed to functions as arguments. So the heading of this article is not so true. Sometimes it is needed to keep track of types, especially in larger projects.<p>The <a href=https://luals.github.io/>Lua Language Server (<abbr title="Language Server Protocol">LSP</abbr>)</a> provides <a href=https://luals.github.io/wiki/annotations/>annotations</a> (triple-dash comments <code>---</code>) to help define and manage the typing system in the Lua language. These annotations allow developers to specify and enforce types within their projects, improving code readability, maintainability, and reducing potential runtime errors. By using these type annotations, you can create structured type definitions for your project, as well as for individual functions, ensuring consistency and clarity throughout the codebase.<p>The <abbr title="Language Server Protocol">LSP</abbr> does not perform type checking at runtime; instead, it is designed solely to enhance the developer experience (<abbr title="Developer Experience">DX</abbr>) within supported code editors. It provides annotations that help document and define types, improving code navigation, autocompletion, and error detection during development.<p>If you’re familiar with <a href=https://www.typescriptlang.org/>TypeScript</a>, Lua annotations work very similarly, but simpler.<p>Consider:<div class=codehilite><pre><span></span><code><span class=c1>---@class (exact) User</span>
<span class=c1>---@field name string</span>
<span class=c1>---@field password string</span>
<span class=c1>---@field age number</span>
<span class=c1>---@field hobbies string[]</span>

<span class=c1>---Creates a new user</span>
<span class=c1>---@param name string</span>
<span class=c1>---@param password string</span>
<span class=c1>---@param age number</span>
<span class=c1>---@param hobbies? string[]</span>
<span class=c1>---@return User</span>
<span class=kd>local</span> <span class=kr>function</span> <span class=nf>createUser</span><span class=p>(</span><span class=n>name</span><span class=p>,</span> <span class=n>password</span><span class=p>,</span> <span class=n>age</span><span class=p>,</span> <span class=n>hobbies</span><span class=p>)</span>
    <span class=n>hobbies</span> <span class=o>=</span> <span class=n>hobbies</span> <span class=ow>or</span> <span class=p>{}</span>
    <span class=kr>return</span> <span class=p>{</span>
        <span class=n>name</span> <span class=o>=</span> <span class=n>name</span><span class=p>,</span>
        <span class=n>password</span> <span class=o>=</span> <span class=n>password</span><span class=p>,</span>
        <span class=n>age</span> <span class=o>=</span> <span class=n>age</span><span class=p>,</span>
        <span class=n>hobbies</span> <span class=o>=</span> <span class=n>hobbies</span>
    <span class=p>}</span>
<span class=kr>end</span>

<span class=kd>local</span> <span class=n>user</span> <span class=o>=</span> <span class=n>createUser</span><span class=p>(</span><span class=s2>"Bill"</span><span class=p>,</span> <span class=s2>"secret"</span><span class=p>,</span> <span class=mi>25</span><span class=p>,</span> <span class=p>{</span><span class=s2>"horses"</span><span class=p>,</span> <span class=s2>"cars"</span><span class=p>})</span>
<span class=n>user</span><span class=p>.</span><span class=n>age</span> <span class=o>=</span> <span class=mi>33</span>
<span class=nb>print</span><span class=p>(</span><span class=n>user</span><span class=p>)</span>
</code></pre></div><p>By adding simple type annotations as comments in your Lua code, you can greatly enhance the developer experience (<abbr title="Developer Experience">DX</abbr>) in your code editor. These annotations enable features like improved type checking, better code completion, and easier refactoring, making development more efficient and error-free.<p>Since the Lua Language Server (<abbr title="Language Server Protocol">LSP</abbr>) operates within your editor rather than at runtime, it helps with static analysis, guiding you while writing code without affecting execution. Installing the <abbr title="Language Server Protocol">LSP</abbr> is straightforward—whether you’re using <a href=/post/turn-neovim-nto-lua-ide.html>install for NeoVim</a>, or <a href="https://marketplace.visualstudio.com/items?itemName=sumneko.lua">VS Code</a>, you can quickly set it up to take advantage of these benefits.<p>Demo in NeoVim:<p><img alt="Demonstration of Lua Annotation in NeoVim" src=/assets/img/lua-lsp-annotations.gif><h2 id=when-might-you-need-type-annotations>When Might You Need Type Annotations?<a title="Permanent link" class=headerlink href=#when-might-you-need-type-annotations>#</a></h2><ol><li>You are developing a large-scale project—later, it will be much easier to debug and catch potential problems during the coding phase.<li>You are working in a team with people of varying skill levels.</ol><h2 id=when-might-you-not-need-annotations>When might you not need annotations?<a title="Permanent link" class=headerlink href=#when-might-you-not-need-annotations>#</a></h2><ol><li>Prototyping—if you need to create a prototype or proof of concept.<li>The project is very small.<li>You are working on the project alone and fully understand your code.</ol><h2 id=some-tips>Some Tips<a title="Permanent link" class=headerlink href=#some-tips>#</a></h2><ol><li>Avoid using the any type whenever possible, as it any effectively disables type checking.<li>Make it a habit to always add annotations, at least for function arguments, using <a href=https://luals.github.io/wiki/annotations/#param>@param</a> and <a href=https://luals.github.io/wiki/annotations/#return>@return</a>. This is a valuable investment in your project.<li>Read and learn from the <a href=https://luals.github.io/wiki/annotations/>documentation</a> to improve your understanding of Lua type annotations.</ol><h2 id=references>References<a title="Permanent link" class=headerlink href=#references>#</a></h2><ul><li><a href=https://luals.github.io/wiki/>Lua Language Server Documentation</a><li><a href=hhttps://emmylua.github.io/annotation.html>Emmy annotations</a></ul><h2>Feedback</h2><p>For feedback, please check the <a href=/me/>contacts</a> section. Before writing, please specify where you came from and who you are. Sometimes spammers go insane. Thank you in advance for your understanding.</article><a href=/>← Back to the index page</a></main><footer><hr><p>(c) 2022-2025 <a href=/me/>xdknight</a> Powered by <a href=https://github.com/hmngwy/jenny>Jenny</a> shell blog engine.<p>Any images on this website may be used, copied and redistributed under the <a href=https://creativecommons.org/licenses/by/4.0/>CC BY 4.0</a> license.<p>Any code on this website may be used, copied and redistributed under the <a href=https://opensource.org/license/MIT>MIT</a> license.<p>This website does not use cookies or any tracking techniques either. Also, this page is fully accessible, responsive, and readable on any device without a single line of JavaScript.</footer>