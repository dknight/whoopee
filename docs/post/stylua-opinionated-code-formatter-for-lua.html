<!DOCTYPE html>
<html lang="en">
  <head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="StyLua is an amazing code formatter inspired by prettier. ">
<meta name="keywords" content="lua, programming, algorithms, data-structures, gamedev, game development, blog, personal">
<meta name="author" content="Dmitri Smirnov">
<meta property="og:type" content="website">
<meta property="og:url" content="https://whoop.ee/post/stylua-opinionated-code-formatter-for-lua.html">
<meta property="og:image" content="https://whoop.ee/assets/img/lua-language.gif">
<meta http-equiv="Content-Security-Policy" content="script-src 'self'">
<meta http-equiv="Content-Security-Policy" content="object-src 'none'">
<title>StyLua is an optimized code formatter for Lua &mdash; Whoopee</title>
<link rel="icon" type="image/x-icon" href="/favicon.ico">
<link rel="stylesheet" href="/assets/css/styles.min.css">
<link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/feed.xml">
<link rel="canonical" href="https://whoop.ee/post/stylua-opinionated-code-formatter-for-lua.html">
</head>
  <body>
      <header>
    <a href="/" class="logo">Whoopee</a>
    <nav class="mainmenu">
      <a href="/me/">About</a>
      <a href="/feed.xml">RSS</a>
    </nav>
  </header>
    <main>
      <a href="/"><em>&larr; Back to the index page</em></a>
      <article>
        <h1>StyLua is an optimized code formatter for Lua</h1>
        <time datetime="2024-04-25">
          April 25, 2024
        </time>
        <!-- Description: StyLua is an amazing code formatter inspired by prettier. -->


<h2 id="setup">Setup</h2>
<p>I have discovered an amazing tool called StyLua for Lua&rsquo;s code formatting.
So you do not need to think about formatting anymore. It works like a
<a href="https://prettier.io/">prettier</a> version of JavaScript or TypeScript,
but for Lua.</p>
<p>It is extremely easy to set up. StyLua can be installed using Rust&rsquo;s
<a href="https://crates.io/crates/stylua">cargo</a> or
<a href="https://www.npmjs.com/package/@johnnymorganz/stylua">npm</a>. It depends on the
packaging tools you prefer; the commands are:</p>
<div class="codehilite"><pre><span></span><code>cargo<span class="w"> </span>install<span class="w"> </span>stylua
</code></pre></div>

<p>or</p>
<div class="codehilite"><pre><span></span><code>npm<span class="w"> </span>i<span class="w"> </span>-g<span class="w"> </span>@johnnymorganz/stylua
</code></pre></div>

<h3 id="neovim">NeoVim</h3>
<p>In my init.lua for <a href="https://neovim.io/">neovim</a>, I just added plugin
<a href="https://github.com/ckipp01/stylua-nvim">ckipp01/stylua-nvim</a> and</p>
<div class="codehilite"><pre><span></span><code><span class="s2">&quot;ckipp01/stylua-nvim&quot;</span>
</code></pre></div>

<p>And <code>BufWritePre</code> hook to format on auto-save.</p>
<div class="codehilite"><pre><span></span><code><span class="n">vim</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">nvim_create_autocmd</span><span class="p">({</span> <span class="s2">&quot;BufWritePost&quot;</span> <span class="p">},</span> <span class="p">{</span>
    <span class="n">pattern</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;*.lua&quot;</span> <span class="p">},</span>
    <span class="n">callback</span> <span class="o">=</span> <span class="kr">function</span><span class="p">()</span>
      <span class="c1">-- more commands if needed</span>
        <span class="n">vim</span><span class="p">.</span><span class="n">cmd</span><span class="p">(</span><span class="s">[[silent! !stylua %]]</span><span class="p">)</span>
    <span class="kr">end</span>
<span class="p">})</span>
</code></pre></div>

<p>My complete init.lua, which is constantly updated, can be checked
on <a href="(https://github.com/dknight/dotfiles/blob/main/init.lua)">GitHub</a>.</p>
<h3 id="vscode">VSCode</h3>
<p>For VSCode, installation is even easier; StyLua extension is available on the
<a href="https://marketplace.visualstudio.com/items?itemName=JohnnyMorganz.stylua">marketplace</a>.
Just one click and install.</p>
<h2 id="configuration">Configuration</h2>
<p>Currently, I am happy with the default settings, except for line width.
I prefer 80 or even 78-column width. Let&rsquo;s fix that.
<a href="https://github.com/JohnnyMorganz/StyLua?tab=readme-ov-file#options">Several options</a>
can be adjusted. Let&rsquo;s <code>stylua.toml</code> somewhere on the system with the contents:</p>
<div class="codehilite"><pre><span></span><code><span class="n">column_width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">78</span>
</code></pre></div>

<p>Now we have 2 options:</p>
<h3 id="set-a-flag-config-path-in-the-stylua-command">Set a flag <code>--config-path</code> in the <code>stylua</code> command</h3>
<div class="codehilite"><pre><span></span><code><span class="n">vim</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">nvim_create_autocmd</span><span class="p">({</span> <span class="s2">&quot;BufWritePost&quot;</span> <span class="p">},</span> <span class="p">{</span>
    <span class="n">pattern</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;*.lua&quot;</span> <span class="p">},</span>
    <span class="n">callback</span> <span class="o">=</span> <span class="kr">function</span><span class="p">()</span>
        <span class="n">vim</span><span class="p">.</span><span class="n">cmd</span><span class="p">(</span><span class="s">[[silent! !stylua --config-path={path-to-stylua.toml} %]]</span><span class="p">)</span>
    <span class="kr">end</span>
<span class="p">})</span>
</code></pre></div>

<h3 id="set-in-plugins-options">Set in plugins options</h3>
<p>Consider we use <a href="https://github.com/folke/lazy.nvim">lazy</a> for NeoVim.</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
    <span class="s2">&quot;ckipp01/stylua-nvim&quot;</span><span class="p">,</span>
    <span class="n">config</span> <span class="o">=</span> <span class="kr">function</span><span class="p">()</span>
        <span class="nb">require</span><span class="p">(</span><span class="s2">&quot;stylua-nvim&quot;</span><span class="p">).</span><span class="n">setup</span><span class="p">({</span>
            <span class="n">config_file</span> <span class="o">=</span> <span class="n">stylua_cfg</span><span class="p">,</span>
        <span class="p">})</span>
    <span class="kr">end</span><span class="p">,</span>
    <span class="p">},</span>
</code></pre></div>

<p>For VSCode it should everything much easier, all configurations should be
available in the extension settings.</p>
<h2 id="conclusion">Conclusion</h2>
<p>There is no need to think about code style while coding in Lua and
concentrate on the tasks; the formatter does its job.
For more detailed editors&rsquo; integration guides
Check out <a href="https://github.com/JohnnyMorganz/StyLua">the official GitHub repo of StyLua</a>.</p>
<h2 id="references">References</h2>
<ul>
<li><a href="https://github.com/JohnnyMorganz/StyLua">Github: StyLua</a></li>
<li><a href="https://roblox.github.io/lua-style-guide/">Roblox Lua Style Guide</a></li>
</ul>
        <h2>Feedback</h2>
<p>
For feedback, please check the <a href="/me/">contacts</a> section.
Before writing, please specify where you came from and who you are. Sometimes spammers go insane.
Thank you in advance for your understanding.
</p>
      </article>
      <a href="/"><em>&larr; Back to the index page</em></a>
    </main>
      <footer>
    <hr>
    <p>
      &copy; 2022&mdash;2024 <a href="/me/">xdknight</a>
      Powered by <a href="https://github.com/hmngwy/jenny">Jenny</a> shell
      blog engine. <a href="https://github.com/dknight/whoopee">Source code</a>
    </p>
    <p>
      Any images on this website may be used, copied and redistributed under the
      <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0 Deed</a> license.
    </p>
    <p>
      Any code on this website may be used, copied and redistributed under the
      <a href="https://opensource.org/license/MIT">MIT</a> license.
    </p>
    <p>
      This website <strong>does not</strong> use cookies or any tracking techniques either.
      Also, this page is fully accessible, responsive, and readable on any
      device without a single line of <abbr title="Tool of evil">JavaScript</abbr>.
    </p>
  </footer>
  </body>
</html>
