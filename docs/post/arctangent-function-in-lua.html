<!doctype html><html lang=en><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><meta content="math.atan and math.atan2 in Lua. Explanation of arctangent function and why it is inconsistent in different versions of Lua. " name=description><meta content="lua, programming, algorithms, data-structures, gamedev, game development, blog, personal" name=keywords><meta content="Dmitri Smirnov" name=author><meta content=website property=og:type><meta content=https://www.whoop.ee/post/arctangent-function-in-lua.html property=og:url><meta content=https://www.whoop.ee/assets/img/whoopee-logo-black.png property=og:image><meta content="script-src 'self'" http-equiv=Content-Security-Policy><meta content="object-src 'none'" http-equiv=Content-Security-Policy><title>Arctangent function in Lua — Whoopee</title><link as=font href=/assets/fonts/Perfect_DOS_VGA_437.woff2 rel=preload><link href=/favicon.ico rel=icon type=image/x-icon><link href=/assets/css/styles.min.css rel=stylesheet><link title="RSS Feed" href=/feed.xml rel=alternate type=application/rss+xml><link href=https://www.whoop.ee/post/arctangent-function-in-lua.html rel=canonical><body><header><a href=/><img alt=Whoopee class=logo height=172 src=/assets/img/whoopee-logo.png width=200></a><nav class=mainmenu><a href=/me/>About</a><a href=/feed.xml>RSS</a></nav></header><main><a href=/>← Back to the index page</a><article><h1>Arctangent function in Lua</h1><time datetime=2024-05-10> May 10, 2024 </time><p>Simple trigonometric function arctangent is very confusing in Lua. In Lua version 5 this function changed many times. I found such variants:<ul><li><code>math.atan(x)</code>: 5.1, 5.2<li><code>math.atan2(x, y)</code>: 5.1, 5.2<li><code>math.atan(y [, x])</code>: 5.3, 5.4</ul><p>It is very confusing. Let’s try to figure out what is what.<h2 id=what-is-the-trigonometric-arctangent-function>What is the trigonometric arctangent function<a title="Permanent link" class=headerlink href=#what-is-the-trigonometric-arctangent-function>#</a></h2><p>Time to remind a school math class.<p>Calculating and finding angles is a very common task for game developers. Arctagnent allows to find the angle between a point and X-axis with ease.<p><img alt="Figure 01. Arctangent angles with arctangent" src=/assets/img/atan01.svg><p>We know two points: <em>A(10, 10) and </em>O(0, 0)* is center. If 2 points are known, then we can make a line between them. General equation of a line (linear function):<div class=codehilite><pre><span></span><code>y = kx + c*
</code></pre></div><p>Where:<ul><li><strong><em>y</em></strong> is the value on the Y-axis.<li><strong><em>k</em></strong> is the tangent of the angle between the line and the X-axis (<strong><em>k = tan(α)</em></strong>).<li><strong><em>x</em></strong> value on the X-axis.<li><strong><em>c</em></strong> offset by the Y-axis.</ul><p>Consider point <strong><em>A(10, 10)</em></strong>:<div class=codehilite><pre><span></span><code>y = tan(α) * x
tan(k) = y/x
α = arctan(y/x)
α = arctan(10/10) = arctan(1)
α ≈ 0.78539 = 45°
</code></pre></div><p>Consider point <strong><em>B(5, -10)</em></strong>:<div class=codehilite><pre><span></span><code>y = tan(α) * x
tan(k) = y/x
α = arctan(y/x)
α = arctan(-10/5) = arctan(-2)
α ≈ -1.107149 ≈ -63.4349°
</code></pre></div><h2 id=lua-function>Lua function<a title="Permanent link" class=headerlink href=#lua-function>#</a></h2><p>Lua’s built-in <code>math</code> library calculates everything written above for you. But there are many versions in different Lua versions and which to use. Usually <code>math.atan()</code> or <code>math.atan2()</code> functions confuse beginners.<div class="admonition warning"><p class=admonition-title>Warning<p>Function <code>math.atan2()</code> is deprecated and might not work in your environment.</div><p>The general rule is to use <code>math.atan()</code> in the form.<div class=codehilite><pre><span></span><code><span class=kd>local</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>10</span>
<span class=nb>print</span><span class=p>(</span><span class=nb>math.atan</span><span class=p>(</span><span class=n>y</span> <span class=o>/</span> <span class=n>x</span><span class=p>))</span> <span class=c1>--> 0.78539816339745 radians which equal 45 degrees</span>
</code></pre></div><p>This should work with every Lua version.<h2 id=conclusion>Conclusion<a title="Permanent link" class=headerlink href=#conclusion>#</a></h2><ul><li>Use <code>math.atan()</code> everywhere possible;<li><code>math.atan2()</code> is deprecated.</ul><h2 id=bonus-converting-radians-to-degrees-and-vice-versa>Bonus: converting radians to degrees and vice-versa<a title="Permanent link" class=headerlink href=#bonus-converting-radians-to-degrees-and-vice-versa>#</a></h2><p>Function to convert radians to degrees:<div class=codehilite><pre><span></span><code><span class=kd>local</span> <span class=kr>function</span> <span class=nf>rad2deg</span><span class=p>(</span><span class=n>r</span><span class=p>)</span>
    <span class=kr>return</span> <span class=n>r</span> <span class=o>*</span> <span class=p>(</span><span class=mi>180</span> <span class=o>/</span> <span class=nb>math.pi</span><span class=p>)</span>
<span class=kr>end</span>
</code></pre></div><p>Function to convert degrees to radians:<div class=codehilite><pre><span></span><code><span class=kd>local</span> <span class=kr>function</span> <span class=nf>deg2rad</span><span class=p>(</span><span class=n>d</span><span class=p>)</span>
    <span class=kr>return</span> <span class=n>d</span> <span class=o>*</span> <span class=p>(</span><span class=nb>math.pi</span> <span class=o>/</span> <span class=mi>180</span><span class=p>)</span>
<span class=kr>end</span>
</code></pre></div><h2 id=references>References<a title="Permanent link" class=headerlink href=#references>#</a></h2><ul><li><a href=https://www.lua.org/manual/5.4/manual.html#pdf-math.atan>Lua manual: math.atan()</a><li><a href=https://en.wikipedia.org/wiki/Inverse_trigonometric_functions>Wikipedia: Inverse trigonometric functions</a><li><a href=https://www.omnicalculator.com/math/arctan>Another good explanation</a></ul><h2>Feedback</h2><p>For feedback, please check the <a href=/me/>contacts</a> section. Before writing, please specify where you came from and who you are. Sometimes spammers go insane. Thank you in advance for your understanding.</article><a href=/>← Back to the index page</a></main><footer><hr><p>(c) 2022-2025 <a href=/me/>xdknight</a> Powered by <a href=https://github.com/hmngwy/jenny>Jenny</a> shell blog engine.<p>Any images on this website may be used, copied and redistributed under the <a href=https://creativecommons.org/licenses/by/4.0/>CC BY 4.0</a> license.<p>Any code on this website may be used, copied and redistributed under the <a href=https://opensource.org/license/MIT>MIT</a> license.<p>This website does not use cookies or any tracking techniques either. Also, this page is fully accessible, responsive, and readable on any device without a single line of JavaScript.</footer>